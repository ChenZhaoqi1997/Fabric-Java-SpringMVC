###系统设计
Fabric系统主要由两个应用构成：Orderer和Peer，其中Orderer负责交易共识并生成区块，Peer节点负责模拟执行交易和记账。这种划分可以使整个平台拥有更好的弹性和扩展性。
Peer和Orderer都是模块化设计，重要模块支持插拔，比如共识机制、合约执行环境、加密算法、证书服务模块等。模块化的设计让企业可以利用现有IT设施来替换部分Fabric模块。
Fabric架构如下图：
![image.png](http://upload-images.jianshu.io/upload_images/4264722-c0b623ba01853bc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


###证书服务——共建信任
上图中最左边是证书服务系统，主要提供会员注册和证书颁发功能，Fabric系统的参与方都必须经过授权，比如Orderer、Peer、Client等都需要拥有受信任的证书。
证书一方面用于系统接入，另一方面用于交易签名。所以统一的证书服务非常重要。
会员证书又分为注册证书和交易证书，注册证书与会员信息关联在一起，用于标识会员的身份，在必要的时候，还可以支持监管和审计；交易证书用于交易签名，之所以交易要用不同的证书，是为了避免会员的个人信息和交易信息被泄露，比如交易内容或者多笔交易之间的关联关系等，另外交易证书可以申请多份，甚至可以为每一笔交易申请一份交易证书。

###共识网络——独特何在
上图中最右侧为区块链共识网络，由Orderer集群组成，用于交易共识并生成区块。区块链是去中心化的，意味着需要多方一起参与交易排序，生成区块。
Orderer目前支持SBFT和Kafka两种共识机制，其中SBFT是拜占庭容错算法PBFT的简化版，能够容忍部分节点故障，Kafka是一个中心化的排队服务，能提供更高的性能，两种共识算法分别适用于不同的场景，用户还可以定制自己的共识模块。
和其他区块链系统不同的是，交易共识在Fabric中被独立成为单独的系统，这样一来，参与共识的节点数变少，共识速度得到提高，Fabric的共识网络支持多链，即多个区块链账本可以共用同一张共识网络，降低系统部署和运维成本。

###区块链节点——便捷调用
区块链节点Peer主要功能是调用智能合约执行交易和记账。
####智能合约
智能合约是运行于区块链上的应用程序，Fabric的智能合约称为链码，分为系统链码和用户链码，系统链码用来实现系统层面的功能，包括系统的配置，用户链码的部署、升级，用户交易的签名和验证策略等。用户链码实现用户的应用功能。
链码被编译成一个独立的应用程序，运行于隔离的Docker容器中，在链码部署的时候会自动生成合约的Docker镜像。
链码支持采用Go、Java、Nodejs编写，并提供相应的中间层供链码使用，链码可以使用GetState和PutState接口和Peer节点通信，存取K-V数据 。
####共享账本
共享账本包括区块文件和K-V状态数据，区块文件存储在本地文件系统，由Peer节点负责写入，文件内容是排序后的区块数据，每个文件有大小限制，存储一定数量的区块，区块由交易共识系统产生，包含一条或多条交易。

K-V状态数据提供给链码存取使用，采用LevelDB存储。